# Apps SDK Adapter

This adapter enables MCP-UI widgets to work in Apps SDK environments (e.g., ChatGPT).

## Architecture

### Files

- **`adapter-runtime.ts`** - The actual TypeScript implementation with full type safety ✅
  - Edit this file to modify adapter behavior
  - Full TypeScript autocomplete, type checking, and refactoring support
  - Can be unit tested

- **`adapter-runtime.bundled.ts`** - Auto-generated bundled version
  - Generated by running `pnpm run bundle:adapter`
  - Minified, self-contained script
  - **DO NOT EDIT THIS FILE DIRECTLY**


- **`adapter.ts`** - Wrapper that injects the bundled script
  - Imports the bundled runtime
  - Adds configuration
  - Returns injectable `<script>` tag

- **`types.ts`** - TypeScript type definitions

- **`index.ts`** - Public exports

## Development Workflow

### Editing the Adapter

1. Edit `adapter-runtime.ts` with full TypeScript support
2. Run `pnpm run bundle:adapter` to regenerate the bundled version
3. The bundled script is automatically regenerated before builds via `prebuild` hook

### Building

```bash
# Bundle the adapter runtime
pnpm run bundle:adapter

# Build the entire server SDK (automatically bundles first)
pnpm run build
```

### Why This Architecture?

**Before**: Adapter was a static string - hard to edit, no type safety ❌

**Now**: Proper TypeScript file that gets bundled ✅

**Benefits**:
- ✅ Full TypeScript support (autocomplete, type checking, refactoring)
- ✅ Better maintainability and code organization  
- ✅ Can unit test the adapter class
- ✅ Still produces injectable script for HTML

**Trade-off**: Need to run bundle script after editing `adapter-runtime.ts`, but this happens automatically during build.

## How It Works

1. **Development**: Edit `adapter-runtime.ts` with full TypeScript
2. **Build Time**: `bundle-adapter.js` script uses esbuild to:
   - Compile TypeScript to JavaScript
   - Bundle into single file (no dependencies)
   - Minify for production
   - Save as `adapter-runtime.bundled.ts` (auto-generated, not committed to git)
3. **Runtime**: `adapter.ts` imports bundled script and injects it into HTML

## Usage

```typescript
import { getAppsSdkAdapterScript } from '@mcp-ui/server';

// Get injectable script
const script = getAppsSdkAdapterScript({
  intentHandling: 'prompt',
  timeout: 30000
});

// Inject into HTML
const html = `<html><head>${script}</head><body>...</body></html>`;
```

